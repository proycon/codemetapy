<div class="reference" about="{{ ref }}" typeof="{{ g.value(ref, RDF.type ) }}">

<ul>
     {% for label, res2 in get_triples(g, res, SDO.author) %}
     <li property="schema:author">
         {% include 'reference_author.html' %}
     </li>
     {% endfor %}
</ul>

{% if g.value(ref, SDO.datePublished) %}
(<span property="schema:datePublished">{{ g.value( ref , SDO.datePublished) }}</span>)
{% elif g.value(ref, SDO.isPartOf) and g.value( g.value(ref, SDO.isPartOf) , SDO.datePublished) %}
(<span property="schema:datePublished">{{ g.value( g.value(ref, SDO.isPartOf) , SDO.datePublished) }}</span>)
{% endif %}


{% if g.value(ref, SDO.url) %}
<a href="{{ g.value(ref, SDO.url) }}" rel="schema:url">
{% endif %}
<span property="schema:name">{{ g.value(ref, SDO.name) }}</span>
{% if g.value(ref, SDO.url) %}
</a>

{% if g.value(ref, SDO.isPartOf) and g.value( g.value(ref, SDO.isPartOf) , SDO.datePublished) %}
{% set parentref = g.value(ref, SDO.isPartOf) %}
<span about="{{ parentref }}" typeof="{{ g.value(parentref, RDF.type) }}">
In:
{% if g.value(parentref, SDO.name) %}
<span property="schema:name">{{ g.value(parentref, SDO.name) }}</span>
{% endif %}
{% if g.value(parentref, SDO.issue) %}
, <span property="schema:issue">{{ g.value(parentref, SDO.issue) }}</span>
{% endif %}
</span>
{% endif %}

{% if g.value(ref, SDO.pageStart)  and g.value(ref, SDO.pageEnd) %}
, <span property="schema:pageStart">{{ g.value(ref, SDO.pageStart) }}</span>-<span property="schema:pageEnd">{{ g.value(ref, SDO.pageEnd) }}</span>
{% elif g.value(ref, SDO.pagination) %}
, <span property="schema:pagination">{{ g.value(ref, SDO.pagination) }}</span>
{% endif %}

{% if ref.find("doi.org") %}
, <a property="schema:identifier" href="{{ ref }}">{{ ref }}</a>
{% elif ref.find("doi:")  != -1 %}
, <span property="schema:identifier">{{ ref }}</a>
{% elif g.value(ref, SDO.identifier) %}
, <span property="schema:identifier">{{ g.value(ref, SDO.identifier) }}</span>
{% endif %}
</div>
